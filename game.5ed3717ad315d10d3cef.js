!function(e){function webpackJsonpCallback(t){for(var r,a,o=t[0],h=t[1],l=t[2],c=0,d=[];c<o.length;c++)a=o[c],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&d.push(s[a][0]),s[a]=0;for(r in h)Object.prototype.hasOwnProperty.call(h,r)&&(e[r]=h[r]);for(n&&n(t);d.length;)d.shift()();return i.push.apply(i,l||[]),checkDeferredModules()}function checkDeferredModules(){for(var e,t=0;t<i.length;t++){for(var r=i[t],a=!0,o=1;o<r.length;o++){var n=r[o];0!==s[n]&&(a=!1)}a&&(i.splice(t--,1),e=__webpack_require__(__webpack_require__.s=r[0]))}return e}var t={},s={0:0},i=[];function __webpack_require__(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,__webpack_require__),i.l=!0,i.exports}__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,s){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(__webpack_require__.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)__webpack_require__.d(s,i,function(t){return e[t]}.bind(null,i));return s},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="";var r=window.webpackJsonp=window.webpackJsonp||[],a=r.push.bind(r);r.push=webpackJsonpCallback,r=r.slice();for(var o=0;o<r.length;o++)webpackJsonpCallback(r[o]);var n=a;i.push([22,1]),checkDeferredModules()}([,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CellModel=void 0;t.CellModel=class{constructor({x:e,y:t,row:s,col:i,value:r,width:a,height:o}){this.x=e,this.y=t,this.row=s,this.col=i,this.value=r,this.width=a,this.height=o}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Game=t.swipeDirections=void 0;const i=s(34),r=s(10),a=s(0),o=s(7),n=s(11),h=s(35),l=s(37),c=s(8),d=s(38);t.swipeDirections=[o.Directions.UP,o.Directions.DOWN,o.Directions.RIGHT,o.Directions.LEFT];class u extends i.AbstractGame{constructor(e,t,s){super(e,t,s),this.onGameOverCB=()=>{},this.gameHeader=new d.Header,this.viewLayers.UI.addChild(this.gameHeader),this.update=this.update.bind(this),this.resize=this.resize.bind(this),this.onUserSwipe=this.onUserSwipe.bind(this)}initGame(){this.store=new n.GameStore,this.engine=new o.Engine2048,this.gameField=new h.GameField,this.swipeLayer=new l.SwipeLayer;const e=this.store.getInitData(),t=this.engine.calculateFieldSizes(e),s=this.engine.calculateFieldData(t,e);this.store.setFieldData(s),this.gameField.initViewData(e,a.utils.TextureCache),this.gameField.createField(t,s),this.gameHeader.createUi(),this.viewLayers.Game.addChild(this.gameField),this.viewLayers.UI.addChild(this.swipeLayer),this.resize(this.components.ResizeManager.getCurrentSizes())}startGame(e){this.onGameOverCB=e,this.swipeLayer.activate(this.onUserSwipe),this.generateRandomCells(),this.generateRandomCells()}cleanupGame(){this.gameField.cleanup(),this.swipeLayer.cleanup(),this.viewLayers.Game.removeChild(this.gameField),this.viewLayers.UI.removeChild(this.swipeLayer)}update(e,t){r.update(t)}resize(e){const{game:t,viewport:s,isPortrait:i}=e;this.app.stage.position.set(t.width/2,t.height/2),this.swipeLayer.rotation=i?0:-Math.PI/2,this.swipeLayer.resize(e);const r=550,a=550;let o=1;(i?r-s.width:a-s.height)<0&&(o=i?r/s.width:a/s.height),this.gameField.x=i?0:50*o,this.gameField.y=i?50*o:0,this.gameField.rotation=i?0:-Math.PI/2,this.gameField.scale.set(o),this.gameHeader.x=i?0:-(this.gameField.width/2+150*o),this.gameHeader.y=i?-(this.gameField.height/2+150*o):0,this.gameHeader.rotation=i?0:-Math.PI/2,this.gameHeader.scale.set(o)}generateRandomCells(){const e=this.engine.generateRandomCells(this.store.getFieldCopy());this.store.updateData(e),this.gameField.updateView(e),this.checkIfGameOver()}checkIfGameOver(){const e=t.swipeDirections.map(e=>{const t=this.engine.rotateGrid(e,this.store.getFieldCopy());return this.engine.slideGrid(t)}).some(e=>e.length>0),s=c.flattenDeep(this.store.getFieldCopy()).some(e=>0===e.value);e&&s||this.gameOver()}onUserSwipe(e){const t=this.store.getFieldCopy(),s=this.engine.rotateGrid(e,t),i=this.engine.slideGrid(s);0!==i.length&&(this.store.updateData(i),this.swipeLayer.deactivate(),this.gameField.updateView(i,()=>{this.generateRandomCells(),this.updateScoreLabel(i),this.swipeLayer.activate(this.onUserSwipe)}))}updateScoreLabel(e){const t=e.reduce((e,t)=>e+t.create.filter(e=>e.isNew).reduce((e,t)=>e+t.value,0),0);this.gameHeader.updateScore(t)}gameOver(){this.gameHeader.updateRoundScore(),this.swipeLayer.deactivate(),this.onGameOverCB()}}t.Game=u},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractState=void 0;t.AbstractState=class{constructor(e,t){this.name=e,this.fsm=t}goToNextState(e){this.fsm.changeStateTo(e)}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),r=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||t.hasOwnProperty(s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(s(17),t),r(s(33),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Engine2048=t.Directions=void 0;const i=s(8);var r;s(11),s(3),function(e){e[e.UP=1]="UP",e[e.DOWN=-1]="DOWN",e[e.RIGHT=2]="RIGHT",e[e.LEFT=-2]="LEFT"}(r=t.Directions||(t.Directions={}));t.Engine2048=class{calculateFieldSizes({grid:e,cellSizes:t}){return{width:t.width*e.columns+t.pitch*(e.columns+1),height:t.height*e.rows+t.pitch*(e.rows+1)}}calculateFieldData(e,t){const{grid:s,cellSizes:i}=t;return s.cells.map(t=>t.map(({value:t,row:s,col:r})=>{const{x:a,y:o}=((e,t,s,i)=>({x:-(e.width-2*t.pitch-t.width)/2+(t.width+t.pitch)*s,y:-(e.height-2*t.pitch-t.height)/2+(t.height+t.pitch)*i}))(e,i,r,s);return{x:a,y:o,row:s,col:r,value:t,...i}}))}generateRandomCells(e){const t=e.flat().filter(e=>0===e.value),s=i.random(0,10)<5?2:4;let r=i.random(0,t.length-1);for(;0!==t[r].value;)r=i.random(0,t.length-1);return[{create:[{...t[r],isNew:!0,value:s}],remove:[]}]}rotateGrid(e,t){switch(e){case r.RIGHT:return t.map(e=>e.reverse());case r.LEFT:return t;case r.UP:return this.turnColumnsToRows(t);case r.DOWN:return this.turnColumnsToRows(t).map(e=>e.reverse())}}slideGrid(e){return e.map(e=>this.slideRow(e)).flat()}slideRow(e){const t=[];if(0===e.length)return t;const s=e.shift(),i=e.find(e=>0!==e.value);if(!i)return this.slideRow(e);if(0===s.value)t.push({from:{row:i.row,col:i.col},to:{row:s.row,col:s.col},create:[{...s,value:i.value}],remove:[{...i}]}),s.value=i.value,i.value=0,e.unshift(s);else if(s.value===i.value){const e=s.value+i.value;t.push({from:{row:i.row,col:i.col},to:{row:s.row,col:s.col},create:[{...s,isNew:!0,value:e}],remove:[{...s},{...i}]}),i.value=0}return[...t,...this.slideRow(e)]}turnColumnsToRows(e){const t=[];for(let s=0;s<e[0].length;s+=1){const i=[];for(let t=0;t<e.length;t+=1)i.push(e[t][s]);t.push(i)}return t}}},,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameStore=void 0;const i=s(8),r=s(3);s(7);t.GameStore=class{constructor(){this.initData={cellSizes:{width:100,height:100,pitch:8},grid:{rows:4,columns:4,cells:Array.from({length:4}).map(()=>Array.from({length:4})).map((e,t)=>e.map((e,s)=>({value:0,row:t,col:s})))}},this.gameFieldData=[[]]}getInitData(){return i.cloneDeep(this.initData)}setFieldData(e){this.gameFieldData=e.map(e=>e.map(e=>new r.CellModel(e)))}updateData(e){e.forEach(({create:e=[],remove:t=[]})=>{t.forEach(({row:e,col:t})=>this.gameFieldData[e][t].value=0),e.forEach(({row:e,col:t,value:s})=>this.gameFieldData[e][t].value=s)})}getFieldCopy(){return i.cloneDeep(this.gameFieldData)}isGridFull(){return this.gameFieldData.every(e=>e.every(e=>0!==e.value))}}},,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractLayer=void 0;const i=s(0);class r extends i.Container{constructor(e,t){super(),this.name=e,this.zIndex=t}}t.AbstractLayer=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cell=void 0;const i=s(10);s(3);const r=s(19);class a extends r.AbstractCell{constructor(e,t){super(e,t),this.currentTween=null}stopTween(){this.currentTween&&this.currentTween.stop()}scaleUp(){return this.scale.set(.7),this.currentTween=new i.Tween(this.scale).to({x:1,y:1},400).easing(i.Easing.Elastic.Out).start(),this}slideTo({x:e,y:t},s){const r=Math.sqrt(Math.pow(e-this.x,2)+Math.pow(t-this.y,2))/2.5;return this.currentTween=new i.Tween(this.position).to({x:e,y:t},r).onComplete(()=>s()).start(),this}}t.Cell=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractCell=void 0;const i=s(0);s(3);class r extends i.Sprite{constructor(e,{row:t,col:s,value:i=0}){super(e),this.row=t,this.col=s,this.value=i,this.anchor.set(.5)}}t.AbstractCell=r},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),r=s(30),a=s(31),o=s(41),n=s(42),h=s(45),l=s(46),c=s(47),d=s(4),u=s(48),p=s(49),{application:m,isDevMode:w,gameCanvasId:g}=new c.GameConfig;m.view=document.body.querySelector(g);const v=new i.Application(m),f={ResizeManager:new h.ResizeManager(v.renderer,m),AssetsLoader:new n.AssetsPreloader(v.loader),GameLoop:new l.GameLoop(v.ticker)},createLayer=(e,t)=>{const s=new i.Container;return s.name=e,s.zIndex=t,s},S={Background:createLayer("Background",0),Game:createLayer("Game",100),UI:createLayer("UI",200),Foreground:createLayer("Foreground",300)},y=new d.Game(v,f,S),b=new r.StateMachine(y);b.registerStates([new a.SplashState("SplashState",b),new o.CreateState("CreateState",b),new u.GameState("GameState",b),new p.GameOverState("GameOverState",b)]),b.changeStateTo("SplashState"),w&&(window.__GAME=y,window.__FSM=b)},,,,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StateMachine=void 0;t.StateMachine=class{constructor(e){this.target=e,this.states=[],this.currentState=void 0,this.previousState=void 0}changeStateTo(e){const onExitFinished=()=>{const t=this.getStateByName(e);t.onEnterState(),this.swapStates(t)};this.currentState?this.currentState.onExitState(onExitFinished):onExitFinished()}registerStates(e){Array.isArray(e)||(e=[e]),e.forEach(e=>this.states.push(e))}getStateByName(e){const t=this.states.find(t=>t.name===e);return t||new Error(`State: ${e} does not exist!`),t}swapStates(e){this.previousState=this.currentState,this.currentState=e,console.log(`%c State was change!\n            previous state: ${this.previousState&&this.previousState.name}\n            current state: ${this.currentState&&this.currentState.name}`,"color: white; background: black; font-size: 15px")}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SplashState=void 0;const r=s(5),a=s(32);s(4);const o=i(s(40));class n extends r.AbstractState{constructor(){super(...arguments),this.splashAssetsNames=["2","0","4","8"]}onEnterState(){const e=o.default.images.filter(e=>this.splashAssetsNames.includes(e.name)),{AssetsLoader:t}=this.fsm.target.components;t.addAssetsList({images:e}),t.load(()=>{this.showSplashAnimation(o.default)})}onExitState(e){const{ResizeManager:t,GameLoop:s}=this.fsm.target.components,{Foreground:i}=this.fsm.target.viewLayers,r=i.getChildByName("SplashAnimation",!0);i.removeChild(r).cleanup(),t.remove("Loading"),s.remove("Loading"),e()}showSplashAnimation(e){const{ResizeManager:t,GameLoop:s,AssetsLoader:i}=this.fsm.target.components,{Foreground:r}=this.fsm.target.viewLayers,o=r.addChild(new a.SplashAnimation("SplashAnimation",1));t.add("Loading",o.resize),s.add("Loading",o.update),t.resize({}),i.addAssetsList(e),Promise.all([i.load(),o.runAnimations()]).then(()=>this.goToNextState("CreateState")).catch(e=>console.warn(e))}}t.SplashState=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SplashAnimation=void 0;const i=s(0),r=s(10),a=s(6),o=s(18);class n extends a.AbstractLayer{constructor(e,t){super(e,t),this.timers=[],this.cells=[],this.cellsContainer=this.addChild(new i.Container),this.resize=this.resize.bind(this),this.update=this.update.bind(this)}async runAnimations(){return this.createCells(),this.setContainerMask(),await this.animateIn(),await this.animateOut(),await this.animateIn(),await this.animateOut(),Promise.resolve()}resize(e){const{game:t,isPortrait:s,viewport:i}=e;this.position.set(t.width/2,t.height/2);const r=550,a=550;let o=1;(s?r-i.width:a-i.height)<0&&(o=s?r/i.width:a/i.height),this.cellsContainer.scale.set(o)}update(e,t){r.update(t)}cleanup(){this.timers.forEach(e=>e.stop()),this.timers=[],this.removeChildren()}createCells(){this.cells=[new o.Cell(i.utils.TextureCache[2],{col:0,row:0,value:0}),new o.Cell(i.utils.TextureCache[0],{col:0,row:0,value:0}),new o.Cell(i.utils.TextureCache[4],{col:0,row:0,value:0}),new o.Cell(i.utils.TextureCache[8],{col:0,row:0,value:0})].reverse(),this.cellsContainer.addChild(...this.cells)}setContainerMask(){const e=(new i.Graphics).beginFill(16711680,.8).drawRect(-1,-1,2,2).endFill();e.width=480,e.height=120,this.cellsContainer.mask=e,this.cellsContainer.addChild(e)}animateIn(){return this.cells.forEach((e,t)=>{e.x=-300,new r.Tween({}).to({},200*t).onComplete(()=>{e.slideTo({x:150-100*t,y:0},e.scaleUp.bind(e))}).start()}),new Promise(e=>{new r.Tween({}).to({},1500).onComplete(()=>e()).start()})}animateOut(){return this.cells.map((e,t)=>new r.Tween({}).to({},200*t).onComplete(()=>{e.slideTo({x:300,y:0},()=>{})}).start()),new Promise(e=>{new r.Tween({}).to({},1500).onComplete(()=>e()).start()})}}t.SplashAnimation=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DraggableLayer=void 0;const i=s(17);class r extends i.AbstractLayer{constructor(e,t,s){super(e,t),this.isClicked=!1,this.pointersId=[],this.viewPortSizes=s,this.pointerStartPos={x:0,y:0},this.moveBy={dx:0,dy:0},this.on("pointerdown",this.onPointerDown,this),this.on("pointermove",this.onPointerMove,this),this.on("pointerup",this.onPointerUp,this),this.on("pointerupoutside",this.onPointerUp,this)}activate(){this.interactive=!0}deactivate(){this.interactive=!1}onPointerDown({data:e}){this.isClicked||(this.pointersId.push(e.pointerId),this.isClicked=!0,this.pointerStartPos=e.getLocalPosition(this))}onPointerMove({data:e}){this.isClicked&&this.calculateMove(e)}onPointerUp({data:e}){-1===this.pointersId.indexOf(e.pointerId)&&(this.pointersId=[],this.isClicked=!1)}calculateMove(e){const t=e.getLocalPosition(this);this.moveBy={dx:t.x-this.pointerStartPos.x,dy:t.y-this.pointerStartPos.y}}move(){const{x:e,y:t}=this.position,{width:s,height:i}=this.viewPortSizes,r=this.getLocalBounds(),a=e+this.moveBy.dx,o=t+this.moveBy.dy;this.moveBy={dx:0,dy:0};const n=(r.width-s)/2,h=(r.height-i)/2;this.position.set(Math.min(Math.abs(a),n)*Math.sign(a),Math.min(Math.abs(o),h)*Math.sign(o))}update(){this.move()}resize(){}cleanup(){}}t.DraggableLayer=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractGame=void 0;t.AbstractGame=class{constructor(e,t,s){this.app=e,this.components=t,this.viewLayers=s;const i=Object.values(this.viewLayers);this.app.stage.addChild(...i),this.app.stage.sortableChildren=!0}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameField=void 0;const i=s(8),r=s(0);s(7),s(11),s(3),s(36);const a=s(18),o=s(6);class n extends o.AbstractLayer{constructor(){super("GameField",0),this.texturesMap={},this.playableCells=[]}initViewData(e,t){const createArr=e=>Array.from({length:e});this.playableCells=createArr(e.grid.rows).map(()=>createArr(e.grid.columns).fill(null)),this.texturesMap=t}createField(e,t){const s=this.addChild(r.Sprite.from("background"));s.height=e.height,s.width=e.width,s.anchor.set(.5),t.forEach(e=>{e.forEach(({x:e,y:t})=>{const s=this.addChild(r.Sprite.from("empty"));s.position.set(e,t),s.anchor.set(.5)})}),this.cellsContainer=this.addChild(new r.Container)}updateView(e=[],t=(()=>{})){const s=i.after(e.length,()=>t());e.forEach(({from:e,to:r,remove:a,create:o})=>{var n,h;if(!e||!r)return void this.onCellSlided(a,o,t);const l=this.playableCells[e.row][e.col],c={x:null===(n=i.first(o))||void 0===n?void 0:n.x,y:null===(h=i.first(o))||void 0===h?void 0:h.y};l.slideTo(c,()=>this.onCellSlided(a,o,s))})}resize(e){}update(e,t){}cleanup(){this.removeAllListeners(),this.cellsContainer.removeChildren(),this.removeChildren(),this.texturesMap={},this.playableCells=[]}onCellSlided(e=[],t=[],s=(()=>{})){e.forEach(({col:e,row:t})=>{this.cellsContainer.removeChild(this.playableCells[t][e]),this.playableCells[t][e]=null}),t.forEach(e=>{const t=new a.Cell(this.texturesMap[e.value],e);t.position.set(e.x,e.y),this.playableCells[t.row][t.col]=t,this.cellsContainer.addChild(t),e.isNew&&t.scaleUp()}),s()}}t.GameField=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyCell=void 0;const i=s(19);class r extends i.AbstractCell{}t.EmptyCell=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SwipeLayer=t.KeyCodes=void 0;const i=s(6),r=s(0),a=s(7);var o;!function(e){e[e.UP=38]="UP",e[e.DOWN=40]="DOWN",e[e.RIGHT=39]="RIGHT",e[e.LEFT=37]="LEFT"}(o=t.KeyCodes||(t.KeyCodes={}));class n extends i.AbstractLayer{constructor(){super("SwipeLayer",1e3),this.minSwipeDistance=100,this.pointersId=[],this.pointersPos={start:new r.Point,end:new r.Point},this.onPointerDown=this.onPointerDown.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onUserSwipe=()=>{}}activate(e){window.addEventListener("keydown",this.onKeyDown),this.on("pointerdown",this.onPointerDown),this.on("pointerupoutside",this.onPointerUp),this.on("pointerup",this.onPointerUp),this.onUserSwipe=e,this.interactive=!0}deactivate(){window.removeEventListener("keydown",this.onKeyDown),this.off("pointerdown",this.onPointerDown),this.off("pointerupoutside",this.onPointerUp),this.off("pointerup",this.onPointerUp),this.onUserSwipe=()=>{},this.interactive=!1}resize(e){this.setSwipeArea(e)}update(){throw new Error("Method not implemented.")}cleanup(){this.deactivate(),this.removeChildren()}onKeyDown({keyCode:e}){let t;switch(e){case o.LEFT:t=this.isPortrait?a.Directions.LEFT:a.Directions.UP;break;case o.RIGHT:t=this.isPortrait?a.Directions.RIGHT:a.Directions.DOWN;break;case o.DOWN:t=this.isPortrait?a.Directions.DOWN:a.Directions.LEFT;break;case o.UP:t=this.isPortrait?a.Directions.UP:a.Directions.RIGHT;break;default:return}this.onUserSwipe(t)}onPointerDown({data:e}){Boolean(this.pointersId.length)||(this.pointersId.push(e.pointerId),this.pointersPos.start=e.getLocalPosition(this))}onPointerUp({data:e}){this.pointersId.includes(e.pointerId)&&(this.pointersPos.end=e.getLocalPosition(this),this.isSwipe(this.pointersPos)&&this.onUserSwipe(this.calcSwipeDir(this.pointersPos)),this.pointersId=[],this.pointersPos={start:new r.Point,end:new r.Point})}calcSwipeDir({start:e,end:t}){const s=t.x-e.x,i=t.y-e.y;return Math.abs(s)>Math.abs(i)?s>0?a.Directions.RIGHT:a.Directions.LEFT:i>0?a.Directions.DOWN:a.Directions.UP}isSwipe({end:e,start:t}){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))>=this.minSwipeDistance}setSwipeArea(e){const{game:{width:t},isPortrait:s}=e,i=new r.Rectangle(-t/2,-t/2,t,t);this.hitArea=i,this.isPortrait=s}}t.SwipeLayer=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const i=s(0),r=s(6),a=s(39);class o extends r.AbstractLayer{constructor(){super("Header",1),this.isCreated=!1}createUi(){this.isCreated||(this.isCreated=!0,this.logoText=this.addChild(new i.Text("2048",{fill:7827302,fontSize:70,fontFamily:"Verdana, Geneva, sans-serif",fontWeight:"bold"})),this.logoText.position.set(-205,-5),this.currentScore=this.addChild(new a.ScoreLabel("SCORE",0)),this.currentScore.position.set(130,0),this.besetScore=this.addChild(new a.ScoreLabel("BEST",2048)),this.besetScore.position.set(130,90))}updateRoundScore(){const e=this.currentScore.getScore(),t=this.besetScore.getScore();this.currentScore.resetScore(),this.besetScore.resetScore(),this.besetScore.addScore(Math.max(e,t))}updateScore(e){this.currentScore.addScore(e)}resize(e){}update(){}cleanup(){}}t.Header=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScoreLabel=void 0;const i=s(0);class r extends i.Container{constructor(e,t){super(),this.score=t,this.background=this.addChild(i.Sprite.from("background")),this.background.width=180,this.background.height=80,this.background.anchor.set(.5,0),this.labelText=this.addChild(new i.Text(e,{fill:15130325,fontSize:20,fontFamily:"Verdana, Geneva, sans-serif",fontWeight:"bold"})),this.labelText.position.set(0,8),this.labelText.anchor.set(.5,0),this.scoreText=this.addChild(new i.Text(String(t),{fill:16777215,fontSize:32,fontFamily:"Verdana, Geneva, sans-serif",fontWeight:"bold"})),this.scoreText.position.set(0,32),this.scoreText.anchor.set(.5,0)}addScore(e){this.score+=e,this.renderScore()}resetScore(){this.score=0,this.renderScore()}getScore(){return this.score}renderScore(){this.scoreText.text=String(this.score)}}t.ScoreLabel=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={images:[{name:"0",url:"assets/images/0.png"},{name:"1024",url:"assets/images/1024.png"},{name:"128",url:"assets/images/128.png"},{name:"16",url:"assets/images/16.png"},{name:"2",url:"assets/images/2.png"},{name:"2048",url:"assets/images/2048.png"},{name:"256",url:"assets/images/256.png"},{name:"32",url:"assets/images/32.png"},{name:"4",url:"assets/images/4.png"},{name:"4096",url:"assets/images/4096.png"},{name:"512",url:"assets/images/512.png"},{name:"64",url:"assets/images/64.png"},{name:"8",url:"assets/images/8.png"},{name:"8192",url:"assets/images/8192.png"},{name:"background",url:"assets/images/background.png"},{name:"empty",url:"assets/images/empty.png"}],atlases:[],fonts:[{name:"Coneria",url:"assets/fonts/Coneria.ttf"}]}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateState=void 0;const i=s(5);s(4);class r extends i.AbstractState{onEnterState(){this.fsm.target.initGame(),window.setTimeout(()=>this.goToNextState("GameState"))}onExitState(e){e()}}t.CreateState=r},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AssetsPreloader=void 0;const r=s(0),a=i(s(43)),o=i(s(44));class n extends r.utils.EventEmitter{constructor(e){super(),this.assets={},this.options={crossOrigin:"anonymous"},this.loadedItemsCount=0,this.totalItemsCount=0,this.loadersMap={images:e=>e.loadImages(),fonts:e=>e.loadFonts(),atlases:e=>e.loadAtlases()},this.loader=e,this.assets={},this.totalItemsCount=0}cleanupAssetsList(){this.assets={}}addAssetsList(e){this.assets=e,this.totalItemsCount=Object.values(this.assets).reduce((e,t)=>e+t.length,0)}load(e=(()=>{}),t=(e=>e)){const s=Object.keys(this.assets).map(e=>this.loadersMap[e](this)),i=new Promise(e=>{this.loader.load(()=>e())});return s.push(i),this.onProgressCb=t,this.onCompleteCb=e,new Promise(e=>Promise.all(s).then(()=>{this.promiseResolveCb=e,this.handleComplete()}))}loadImages(){const{images:e=[]}=this.assets;return e.forEach(({name:e,url:t})=>{a.default(this.loader.resources,e)||this.loader.add(e,t,this.options)}),this.loader.onProgress.add(()=>this.incrementProgress()),Promise.resolve()}loadAtlases(){const{atlases:e=[]}=this.assets;return e.forEach(({name:e,url:t})=>{a.default(this.loader.resources,e)||this.loader.add(e,t,this.options)}),this.loader.onProgress.add(()=>this.incrementProgress()),Promise.resolve()}loadFonts(){const{fonts:e=[]}=this.assets,t=document.getElementsByTagName("head")[0],s=e.map(({name:e,url:s})=>{const i=document.createElement("style");return i.setAttribute("type","text/css"),i.appendChild(document.createTextNode(`@font-face { font-family:${e}; src: url(${s}); }`)),t.appendChild(i),new o.default(e).load().then(()=>this.incrementProgress())});return Promise.all(s).then(()=>Promise.resolve())}incrementProgress(){if(this.loadedItemsCount!==this.totalItemsCount){if(this.loadedItemsCount+=1,this.onProgressCb){const e=Math.floor(this.loadedItemsCount/this.totalItemsCount*100);this.onProgressCb(e),this.emit("assetsPreloader:progress",e)}this.loadedItemsCount===this.totalItemsCount&&this.handleComplete()}}handleComplete(){this.promiseResolveCb&&this.loadedItemsCount===this.totalItemsCount&&(this.onCompleteCb&&this.onCompleteCb(),this.promiseResolveCb(),this.emit("assetsPreloader:complete"))}}t.AssetsPreloader=n},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResizeManager=void 0;t.ResizeManager=class{constructor(e,t){this.renderer=e,this.baseSize=t,this.list=new Map,this.currentSizes={game:{width:0,height:0},viewport:{width:0,height:0},isPortrait:!1},this.resize=this.resize.bind(this),window.addEventListener("resize",this.resize)}has(e){return this.list.has(e)}add(e,t){if(this.list.has(e))throw new Error(`ResizeManager: You can not add '${e}' twice!`);this.list.set(e,t)}remove(e){if(!this.list.has(e))throw new Error(`ResizeManager: '${e}' does not exist in ResizeManager list!`);this.list.delete(e)}getCurrentSizes(){return JSON.parse(JSON.stringify(this.currentSizes))}resize(){const{innerHeight:e,innerWidth:t}=window,{width:s,height:i}=this.baseSize,r=e>t,a={width:t,height:e},o={width:0,height:0};r?(o.width=s,o.height=i*(e/t)|0):(o.height=i,o.width=s*(t/e)|0),this.renderer.resize(o.width,o.height),this.renderer.view.style.width=a.width+"px",this.renderer.view.style.height=a.height+"px",this.currentSizes={game:o,viewport:a,isPortrait:r},this.list.forEach(e=>e(this.getCurrentSizes()))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameLoop=void 0;t.GameLoop=class{constructor(e){this.ticker=e,this.list=new Map,this.update=this.update.bind(this),this.ticker.add(this.update)}has(e){return this.list.has(e)}add(e,t){if(this.list.has(e))throw new Error(`GameLoop: You can not add '${e}' twice!`);this.list.set(e,t)}remove(e){if(!this.list.has(e))throw new Error(`GameLoop: '${e}' does not exist in Ticker list!`);this.list.delete(e)}update(e){this.list.forEach(t=>{t(e,this.ticker.lastTime)})}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameConfig=void 0;t.GameConfig=class{constructor(){this.isDevMode=!0,this.prodUrl="",this.devUrl="",this.containerUiId="#game-ui",this.gameCanvasId="#game-canvas",this.containerId="#game-container",this.application={autoDensity:!0,backgroundColor:16447727,width:480,height:480,view:{}}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameState=void 0;const i=s(5);s(4);class r extends i.AbstractState{onEnterState(){const e=this.fsm.target;e.components.ResizeManager.add("Game",e.resize),e.components.GameLoop.add("Game",e.update),e.startGame(()=>this.onGameOver())}onExitState(e){const t=this.fsm.target;t.components.ResizeManager.remove("Game"),t.components.GameLoop.remove("Game"),e()}onGameOver(){window.setTimeout(()=>{this.goToNextState("GameOverState")},1500)}}t.GameState=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameOverState=void 0;const i=s(5);s(4);class r extends i.AbstractState{onEnterState(){window.setTimeout(()=>{this.fsm.target.cleanupGame(),this.goToNextState("CreateState")},1)}onExitState(e){e()}}t.GameOverState=r}]);